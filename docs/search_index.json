[["index.html", "La raport intermédiaire Introduction", " La raport intermédiaire Antoine Viguié, Aymane Berriane, Christian Alvarez Leon, Meng Wang, Yu PENG 2020-12-08 Introduction On observe régulièrement sur la Côte d’Azur, notamment à l’automne, de forts épisodes pluvieux, pouvant engendrer des crues. Par exemple, le 23 novembre 2019, des inondations exceptionnelles se sont produites sur la Côte d’Azur et ont inondé les plaines alluviales de l’Argens, de la Siagne et de la Brague notamment. Plus récemment, début octobre 2020, les vallées de la Roya, de la Vésubie ont été ravagées par des inondations, avec 500 mm relevés pendant l’épisode à Saint-Martin-Vésubie (“Météo-France” n.d.), du jamais vu à cette station depuis les relevés météorologiques. En raison de la nature destructrice des inondations, des recherches hydrologiques sur les bassins versants doivent être menées pour prendre les mesures d’anticipation et de protection de la population. Ceci nécessite par exemple de mesurer le débit sur des sections de cours d’eau non instrumentées en appareils de mesure. Dans notre projet, le but est de calculer le débit d’une section du canal de la Siagne par le logiciel Fudaa-LSPIV. Celui-ci permet de traiter des séquences d’images ou des vidéos d’écoulements pour calculer les champs de vitesse de surface et débit de la section choisie. Ce logiciel peut s’avérer utile pour mesurer le débit de sections de rivières avec un fort courant et de nombreux objets flottants, car les méthodes classiques seraient susceptibles d’abîmer le matériel. Il s’avèrera aussi nécessaire d’utiliser une autre méthode de mesure de débit, comme l’ADCP, pour comparer les résultats obtenus. "],["contexte-du-projet.html", "Chapitre 1 Contexte du projet 1.1 Zone d’action 1.2 Présentation des méthodes LSPIV", " Chapitre 1 Contexte du projet 1.1 Zone d’action Le canal de la Siagne permet d’acheminer l’eau prélevée dans la Siagne depuis Saint-Cézaire-sur-Siagne jusqu’à Cannes sur un parcours de 50 km . La section étudiée est située à Mougins, dans le département des Alpes-Maritimes (figure 1.1) ). Datant de 1868, c’est un ouvrage hydraulique de transport et d’alimentation en eau vers la ville de Grasse ainsi que Cannes et ses environs. Désormais élément du paysage local, le canal s’étend à ciel ouvert sur une grande partie. La section étudiée est facilement accessible à pieds comme en voiture, ce qui facilite les mesures. Puis, la forme du canal est simple et le débit faible, ce qui donnera une mesure de débit plus précise (“canaldelasiagne.fr. Association de sauvegarde de la Siagne et de son canal” 2019). Figure 1.1: Canal de la Siagne, Mougins 1.2 Présentation des méthodes LSPIV Les méthodes LSPIV (Large Scales Particle Image Velocity) permettent de mesurer le débit d’un cours d’eau à partir de vidéos ou de séquences d’images. Dans le cas d’une séquence d’images, l’intervalle de temps doit être identique entre chaque image. A partir de traceurs visibles, le champ de vitesse est établi sur un logiciel LSPIV. Ce traitement de vidéo ou d’images se découpe en trois étapes : L’enregistrement de la vidéo avec des traceurs et points de référence (GRP) visibles Une étape d’orthorectification corrigeant notamment les problèmes de perspective. Le calcul de la vitesse de déplacement des traceurs pour déterminer le débit. La LSPIV est une méthode applicable quelle que soit le débit ou la taille de la rivière. C’est donc une méthode utilisable aussi bien en période de crue que d’étiage. (Muste, Fujita, and Hauet 2008) ont signalé une erreur moyenne sur la vitesse de 10%. "],["principle.html", "Chapitre 2 Méthodologie 2.1 Orthorectification 2.2 Calcul de la vitesse du déplacement des traceurs 2.3 Calcul de débit", " Chapitre 2 Méthodologie 2.1 Orthorectification Les logiciels LSPIV laissent le choix entre importer une vidéo ou une séquence d’images. Pour une séquence d’images, le nombre d’images par seconde doit être spécifié. En ce qui concerne l’utilisation d’une vidéo, il est nécessaire de préciser la section de la vidéo qui nous intéresse pour le séquençage. De plus doit être indiqué : le nombre d’images ou le temps séparant deux images. Tout ceci permet le séquençage de la vidéo en plusieurs images. Il existe deux méthodes d’orthorectification : La mise à l’échelle est une méthode utilisée lorsque les problèmes liés à la perspective sont négligeables, c’est-à-dire lorsque la caméra est verticale. D’abord, on choisit la résolution de l’image (en m/pixel). Soit on la saisit directement, soit on définit un segment reliant deux points de longueur réelle connue, ce qui définira la résolution. On peut également rentrer les coordonnées de ces deux points. Ensuite, on effectue la transformation. Cela permet si besoin de modifier le repère réel des orthoimages. On peut également remplacer les coordonnées horaires par les coordonnées images. L’onglet « autres » permet de définir le niveau d’eau et les coordonnées des coins de l’orthoimage. L’orthorectification complète permet d’apporter une correction eux problèmes de perspective. Les coordonnées terrain (X,Y,Z) des points de références sont renseignées. Il suffit ensuite de cliquer sur le point de référence pour lui associer ses coordonnées images. Pour une ortho rectification en 3D, il faut au moins 6 points de référence et quatre pour une orthorectification 2D. Il est également possible d’importer les coordonnées des points GRP depuis un fichier .dat. L’étape suivante est la vérification des GRP. Pour cela, on part des coordonnées image des points pour calculer les coordonnées terrain sur le logiciel. On mesure ensuite l’écart entre les coordonnées terrains mesurées sur place et celles mesurées sur le logiciel. Un tableau des écarts est affiché. La dernière étape est une étape de transformation. On commence par indiquer sur le logiciel une zone d’étude rectangulaire pour obtenir des calculs plus rapidement. La résolution doit aussi être adaptée afin que les détails des traceurs soient visibles. Enfin, indiquer le niveau d’eau est essentiel. Ces deux méthodes sont résumées sur la figure 2.1 : Figure 2.1: présentation des différents modes d’orthorectification selon la position de la caméra (source à préciser) 2.2 Calcul de la vitesse du déplacement des traceurs Les logiciels LSPIV calculent la vitesse instantanée de surface d’une rivière ou cours d’eau en utilisant une méthode statique en corrélation croisée, cette méthode détermine le déplacement des traceurs sur les images ortho rectifiées à condition que les traceurs soient visibles à la surface. La méthode analyse statistiquement la position des traceurs en commun sur deux images successives séparées par un intervalle de temps. Cela consiste à calculer la corrélation entre l’aire d’interrogation \\(\\text{AI}\\) centrée sur un point \\(a_{ij}\\) dans la première image, et l’aire \\(\\text{IA}\\) centrée sur un point \\(b_{ij}\\) dans la deuxième image, où \\(\\text{IA}\\) définira la taille des traceurs étudiés dans l’identification des déplacements. Le calcul des déplacements est effectué sur la deuxième image dans l’aire de recherche \\(\\text{SA}\\) sur le point \\(b_{ij}\\) . Figure 2.2: Principe d’identification du déplacement des traceurs (Manuel d’utilisation Fudaa-LSPIV Version 1.6.4) 2.3 Calcul de débit Les logiciels LSPIV utilisent le profil bathymétrique d’une section en travers et la vitesse moyennée de profondeur pour calculer le débit dans cette section. Les points du profil bathymétrique doivent être introduits en commençant par la berge gauche vers la berge droite ; les points aux extrémités devront être à une côte supérieure à celle de la surface de l’eau, et au moins un des points intérieurs aura une côte inferieure à la surface de l’eau. Fudaa-LSPIV calcule la vitesse instantanée de surface à partir de traceurs, mais pour obtenir la vitesse de profondeur Fudaa-LSPIV utilisera un coefficient de vitesse \\(\\alpha\\): \\[\\begin{equation} \\alpha = \\frac{\\text{Vitesse moyenne sur la tranche d&#39;eau}}{\\text{Vitesse de surface}} \\end{equation}\\] Une valeur de \\(\\alpha\\) égale à 0.86 peut être choisie pour un écoulement moyen. La valeur de \\(\\alpha\\) sera inférieure à 0.86 en écoulements peu profond ou rugueux, et pour les écoulements de majeur profondeur ou lisse \\(\\alpha\\) sera supérieure à 0.86 (Hauet et al. 2013) . "],["conclusion.html", "Chapitre 3 Conclusion", " Chapitre 3 Conclusion Au cours de cette première phase du projet, nous avons appris à utiliser le logiciel Fudaa-LSPIV avec une banque de vidéos fournies par (“L’IRSTEA” n.d.): par exemple avec les fichiers Video_GDH_1.mp4 ou Video_GDH_2.mp4. Nous avons aussi regardé attentivement la bibliographie fournie ainsi que d’autres sources pour avoir des connaissances sur ces méthodes de calcul de débit. Lors de cette phase, nous avons eu aussi des discussions avec nos encadrants pour définir les contours exacts du sujet, étant donné que deux groupes d’étudiants étaient positionnés sur le sujet suivant : « Crues de 2019 sur la Côte d’Azur : comparaison de débits estimés par analyses d’image (LSPIV) et par modélisation hydraulique ». Le contenu a donc été modifié, pour travailler sur un canal de la région, le canal de la Siagne, quelles que soient les conditions météorologiques (période de crue ou non). Après cette manipulation du logiciel Fudaa-LSPIV et le choix du tronçon du canal à étudier, sera essentielle pour le projet une phase terrain. Celle-ci se déroulera probablement début janvier, le temps notamment d’avoir une autorisation de l’Université. Un inventaire du matériel nécessaire voire un protocole de mesures devra être réalisé. Cette sortie terrain s’organisera en deux temps : Filmer la section du canal de la Siagne à l’aide d’une caméra fixée sur un trépied. Utiliser une autre méthode de mesure de débit comme l’ADCP, ce qui permettra de comparer et donc de valider les résultats du traitement par le logiciel LSPIV. Viendra ensuite la période de traitement de la vidéo sur le logiciel Fudaa-LSPIV et des données recueillies par l’autre méthode de mesure de débit, probablement d’ADCP. Ceci permettra de terminer la rédaction du sujet de TP de mesure du débit par analyse d’image (LSPIV). Ce sujet de TP correspondra au rapport final et sera réalisé, avec le traitement des données recueillies sur le terrain, sur les 3-4 dernières semaines. "],["application-de-la-méthode-lspiv.html", "Application de la méthode LSPIV 1 Image preparation 2 PIV processing", " Application de la méthode LSPIV La technique LSPIV (Large Scale Particle Image Velocimetry) permet de mesurer les vitesses de surface d’un écoulement par analyse de séquence d’images. La méthode LSPIV complète se compose de trois parties principales: la préparation de l’image (voir section 1 ) le traitement PIV (voir section 2 ) l’analyse des données. 1 Image preparation La préparation de l’image est nécessaire pour être en mesure de mieux distinguer les motifs en mouvement de l’imagerie et de supprimer les effets de perspective de l’image. La manipulation d’image pour préparer l’imagerie pour l’analyse LSPIV se composent de plusieurs étapes. Subséquemment, ces étapes sont: (1) La correction de distorsion optique, (2) La stabilisation, (3) l’orthorectification et (4) La mise en niveau de gris et la correction du gamma et du contraste. Les trois premières étapes sont appliquées pour garantir la présence de distances égales dans les images. La quatrième étape est utilisée pour améliorer la distinction de la graine de l’arrière-plan et donc s’assurer de la validation de similitude processus est efficace. Il existe plusieurs logiciels qui permettent d’appliquer des options de manipulation d’images, comme OpenCV3(“OpenCV 3.0. OpenCV” 2015) La correction de distorsion optique En raison de la la courbure des lentilles de l’appareil photo, les images peuvent être déformées. Figure 3.1 présente les deux types de distorsions des lentilles les plus fréquentes,la distorsion en barillet et la distorsion en coussinet (Fryer and Brown 1986) , Ces distorsions géométriques sont liées à des facteurs radiaux. Un troisième type de distorsion est distorsion tangentielle, qui se produit lorsque les lentilles ne sont pas parallèles au plan image. Certaines caméras sont capables de faire face à ces distorsions intérieurement. Cependant, la plupart du temps, une certaine quantité de post-traitement est nécessaire pour ajuster les images. Figure 3.1: Les differentes types de distortion. Du gauche à la droit : la grille d’origine, la distorsion en barillet et la distorsion en coussinet. Les formules suivantes sont appliquées pour supprimer la distortion radial (Voir Équation(3.1)) et la distorsion tangentielle (Voir Équation(3.2)) \\[\\begin{equation} \\begin{aligned} x_{corr} = x\\left(1+k_1r^2+k_2r^4+k_3r^6\\right) \\\\y_{corr} = y\\left(1+k_1r^2+k_2r^4+k_3r^6\\right) \\end{aligned} \\tag{3.1} \\end{equation}\\] D’où \\(\\) et \\(\\) sont les coordonnées d’origine; \\(x_{}\\) et \\(y_{}\\) sont les coordonnées corrigés. \\(\\) est la distance entre le point \\(\\left(, \\right)\\) et le centre de la distortion. \\(_1\\), \\(_2\\), et \\(_3\\) sont les coefficients radiales. Pour la distortion en barillet et la distortion en coussinet , \\(_1\\) est respectivemen negative et positive. \\(_2\\) et \\(_3\\) sont négligeables. \\[\\begin{equation} \\begin{aligned} x_{corr} = x+\\left[ 2 p_1 x y+ p_2\\left( r^2+2x^2\\right) \\right]\\\\ y_{corr} = y+\\left[ p_1 \\left(r^2+2 y^2\\right)+ 2p_2xy\\right] \\end{aligned} \\tag{3.2} \\end{equation}\\] D’où \\(_1\\) et \\(_2\\) sont les coefficient de la distortion tangentielle. les différents coefficients sont souvent stockés dans un tableau: \\[\\begin{equation} C_{dis}= \\begin{bmatrix} k_1 &amp; k_2 &amp; p_1 &amp; p_2 &amp; k_3 \\end{bmatrix} \\end{equation}\\] À part du coefficient de distorsion, pour pouvoir corriger l’imagerie, Une conversion entre les coordonnées de distorsion et la résolution de la caméra est fait. Pour cela, la formule est donnée dans l’équation (3.3) \\[\\begin{equation} \\begin{bmatrix} x\\\\ y\\\\ w \\end{bmatrix} = M_{con} \\cdot \\begin{bmatrix} x\\\\ y\\\\ z \\end{bmatrix} \\quad \\text{d&#39;où} \\quad M_{con} = \\begin{bmatrix} f_x &amp; 0 &amp; c_x\\\\ 0 &amp; f_y &amp; x_y\\\\ 0 &amp; 0 &amp;1 \\end{bmatrix} \\tag{3.3} \\end{equation}\\] D’où \\([, , ]\\) sont les coordonnées d’image homogène 2D et \\([x, y , z]\\) sont les coordonnées de caméra 3D . \\(f_\\) et \\(_\\) sont les longueurs locales de la caméra dans le sens \\(\\) et \\(\\) ,en genéral, ils sont identiques - \\(_\\) et \\(_\\) sont les coordinations de centre optique de la caméra dans le sens \\(\\) et \\(\\). La stabilisation Après avoir appliqué la correction de la distorsion optique , le mouvements d’images possibles peut être supprimé en appliquant la stabilisation de vidéo. Les principales étapes de stabilisation sont (1) l’extraction de points clés sur deux trames séquentielles, (2) faire correspondre les points sur les deux trames, (3) estimer le transformation géométrique, et (4) correction du mouvement. l’orthorectification d’image Pour supprimer les effets de la perspective de l’image – là où les objets sont plus proches de la caméra semble être plus grande que les objets en arrière-plan – , l’orthorectification est appliquée. Lors de l’application d’orthorectification, le système de coordonnées de l’imagerie est transféré à une coordonnée locale système. Pour ce système de coordonnées locales, points de contrôle au sol (GCP) – mis en place à côté du flux – sont utilisés. Pour l’orthorectification processus pour être aussi précis que possible, au moins quatre GCP sont nécessaires, si les images sont capturées perpendiculairement au flux ou lorsque les GCP sont placés au même niveau que le niveau de l’eau. Un minimum de six GCP sont nécessaires lorsque les GCP ne sont pas placés dans le même plan que le niveau d’eau. Sur la Figure 3.2 les différents sites de jaugeage et les configurations sont affichées. Figure 3.2: Nombre de points de contrôle au sol (GCP) nécessaires dans différentes circonstances. Lors de l’utilisation de quatre GCP, les facteurs d’inversion \\(_\\) et \\(_\\) sont déterminé en utilisant la formule indiquée dans l’équation (3.4). \\[\\begin{equation} p_{loc}\\left(x,y\\right)=p_{img}\\left(f_x\\left(x,y\\right), f_y\\left(x,y\\right)\\right) \\tag{3.4} \\end{equation}\\] D’où \\(_ {} \\left (, ,  \\right)\\) est l’emplacement géographique du point de contrôle au sol dans le système de coordonnées local, généralement en métrique units; \\(_ {} \\left (,  \\right)\\) est la coordonnée xy du sol point de contrôle dans l’imagerie, généralement en pixels; et \\(_\\) et \\(_\\) le facteurs d’inversion. Simultanément à ce processus, la résolution de l’image peut être réglée en multipliant les coordonnées \\(_ {} \\left (,  \\right)\\) par les pixels souhaités par coefficient de mètre. Un exemple de le processus d’orthorectification est illustré à la Figure 3.3 . Figure 3.3: Exemple de processus d’orthorectification utilisant quatre GCP, indiqués par des poteaux en bambou le long du ruisseau. Lorsque six (ou plus) GCP sont utilisés - parce que les coordonnées en trois dimensions pour les GCP sont nécessaires - un modèle de sténopé peut être utilisé. Cette méthode est expliqué par (Jodeau et al. 2008) . La mise en niveau de gris et la correction du gamma et du contraste La dernière étape de la préparation de l’image est la conversion du imagerie à une échelle de gris et pour appliquer une correction de contraste et gamma. Une mise à l’échelle des gris est nécessaire pour pouvoir appliquer la validation de similarité entre images vidéo séquentielles. La correction de contraste et gamma est appliquée à améliorer la visibilité des semences. Les corrections de contraste et gamma sont appliqué à l’aide des formules suivantes: \\[\\begin{equation} O_{constract} = \\alpha \\cdot I + \\beta \\tag{3.5} \\end{equation}\\] \\[\\begin{equation} O_{gamma} = \\left(\\frac{I}{255}\\right)^\\frac{1}{\\gamma} \\cdot 255 \\tag{3.6} \\end{equation}\\] D’où \\(\\alpha\\) et \\(\\beta\\) définit la correction du contraste; \\(\\gamma\\) est la correction de gamma; \\(O_n\\) sont les imageries corrigés; et \\(I\\) est l’imagerie d’origine. 2 PIV processing La figure 3.4 montre les étapes du traitement PIV. Pour deux séquentiels cadres, les images sont divisées en cellules de grille. En déterminant validation de similarité - par exemple, une corrélation croisée ou une rapport signal / bruit (Ran et al. 2016 ; Osorio-Cano, Osorio, and Medina 2013) - entre les deux cadres de la zone de recherche, les déplacements peuvent être déterminé. Ces déplacements sont ensuite convertis en vitesse d’écoulement vecteurs. Après avoir appliqué ce processus sur \\(\\) images, un total de \\( 1\\) cartes de vitesse sont créées. Pour chaque carte de vitesse, les résultats peuvent être encore améliorés en appliquant un filtrage supplémentaire basé sur la valeur de similarité dans chaque fenêtre d’interrogation unique, et en remplaçant ces valeurs filtrées par interpolation les cellules de la grille environnantes connues. Ces post-traitements les étapes dépendent du logiciel utilisé ou des résultats requis. Figure 3.4: Vue schématique de la méthode LSPIV où une fenêtre d’interrogation est déterminée (la grille est dessinée plus grande dan généralement appliqué) dans la première image et les graines présentes sont comparées à une zone de recherche dans l’image séquentielle 2 à déterminer leurs déplacements. En multipliant le déplacement par la période de temps de trame, la vitesse est déterminée. Lorsque vous appliquez ceci sur toute l’image, une carte de vitesse d’écoulement de surface peut être créée pour chaque image individuelle. "],["references.html", "REFERENCES", " REFERENCES “canaldelasiagne.fr. Association de sauvegarde de la Siagne et de son canal.” 2019. October 28, 2019. https://canaldelasiagne.fr/. Fryer, John, and Duane Brown. 1986. “Lens Distortion for Close-Range Photogrammetry.” Photogrammetric Engineering and Remote Sensing - PHOTOGRAMM ENG REMOTE SENSING 52 (January): 51–58. Hauet, Alexandre, Magali Jodeau, Jérôme Le Coz, Bertrand Marchand, Andrés Die Moran, Raphaël Le Boursicaud, and Guillaume Dramais. 2013. “Application de La méthode LSPIV Pour La Mesure de Champs de Vitesse, Et de débits de Crue Sur Modèle réduit Et En Rivière.” Journées de l’hydraulique 35 (1): 1–8. https://www.persee.fr/doc/jhydr_0000-0001_2013_act_35_1_1290. Jodeau, M., A. Hauet, A. Paquier, J. Le Coz, and G. Dramais. 2008. “Application and Evaluation of LS-PIV Technique for the Monitoring of River Surface Velocities in High Flow Conditions.” Flow Measurement and Instrumentation 19 (2): 117–27. https://doi.org/10.1016/j.flowmeasinst.2007.11.004. “L’IRSTEA.” n.d. Accessed December 8, 2020. https://forge.irstea.fr/projects/fudaa-lspiv/files. “Météo-France.” n.d. Accessed December 8, 2020. https://meteofrance.com/. Muste, M., I. Fujita, and A. Hauet. 2008. “Large-Scale Particle Image Velocimetry for Measurements in Riverine Environments.” Water Resources Research 44 (4). https://doi.org/https://doi.org/10.1029/2008WR006950. “OpenCV 3.0. OpenCV.” 2015. June 4, 2015. https://opencv.org/opencv-3-0/. Osorio-Cano, Juan David, Andrés F. Osorio, and Raul Medina. 2013. “A Method for Extracting Surface Flow Velocities and Discharge Volumes from Video Images in Laboratory.” Flow Measurement and Instrumentation 33 (October): 188–96. https://doi.org/10.1016/j.flowmeasinst.2013.07.009. Ran, Qi-hua, Wei Li, Qian Liao, Hong-lei Tang, and Meng-yao Wang. 2016. “Application of an Automated LSPIV System in a Mountainous Stream for Continuous Flood Flow Measurements.” Hydrological Processes 30 (17): 3014–29. https://doi.org/https://doi.org/10.1002/hyp.10836. "]]
